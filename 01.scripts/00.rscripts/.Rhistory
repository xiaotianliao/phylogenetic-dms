"Aves" = "#d95f02",             # Dark Orange (Birds)
# Worms
"Polychaeta" = "#7f0000",       # Dark Maroon (Bristle Worms)
"Pilidiophora" = "#7f0000",     # Dark Maroon (Ribbon Worms)
"Enteropneusta" = "#7f0000",    # Dark Maroon (Acorn Worms)
# Insects & Arthropods
"Insecta" = "#7570b3",          # Dark Purple-Blue (Insects)
"Arachnida" = "#7570b3",        # Dark Purple-Blue (Spiders, Scorpions)
"Pycnogonida" = "#7570b3",      # Dark Purple-Blue (Sea Spiders)
"Thecostraca" = "#7570b3",      # Dark Purple-Blue (Barnacles)
"Branchiopoda" = "#7570b3",     # Dark Purple-Blue (Water Fleas)
# Fish
"Myxini" = "#1b9e77",           # Dark Teal (Hagfish)
"Actinopteri" = "#1b9e77",      # Dark Teal (Ray-finned Fishes)
"Chondrichthyes" = "#1b9e77",   # Dark Teal (Cartilaginous Fishes like Sharks)
"Cladistia" = "#1b9e77",        # Dark Teal (Bichirs and Reedfishes)
"Hyperoartia" = "#1b9e77",      # Dark Teal (Lampreys)
# Sponges
"Demospongiae" = "#1f78b4",     # Dark Blue (Common Sponges)
"Calcarea" = "#1f78b4",         # Dark Blue (Calcareous Sponges)
"Homoscleromorpha" = "#1f78b4", # Dark Blue (Simple Sponges)
# Mammals
"Mammalia" = "#7570b3",         # Dark Purple (Mammals, including Primates)
# Clams & Mollusks
"Bivalvia" = "#33a02c",         # Forest Green (Clams, Oysters)
"Gastropoda" = "#33a02c",       # Forest Green (Snails, Slugs)
"Polyplacophora" = "#33a02c",   # Forest Green (Chitons)
# Octopuses & Squids
"Cephalopoda" = "#045a8d",      # Dark Navy Blue (Octopuses, Squids)
# Corals & Cnidarians
"Anthozoa" = "#e6ab02",         # Dark Mustard Yellow (Corals, Sea Anemones)
"Scyphozoa" = "#e6ab02",        # Dark Mustard Yellow (True Jellyfish)
"Hydrozoa" = "#e6ab02",         # Dark Mustard Yellow (Hydras, Portuguese Man O' War)
# Other Echinoderms
"Holothuroidea" = "#006d2c",    # Dark Green (Sea Cucumbers)
"Echinoidea" = "#006d2c",       # Dark Green (Sea Urchins)
"Asteroidea" = "#006d2c",       # Dark Green (Sea Stars)
# Other Miscellaneous
"Lepidosauria" = "#666666",     # Dark Gray (Lizards, Snakes)
"Filasterea" = "#666666",       # Dark Gray (Single-celled organisms related to animals)
"Lingulata" = "#666666",        # Dark Gray (Brachiopods)
"Leptocardii" = "#666666"       # Dark Gray (Lancelets)
# Unknown/NA category
"NA" = "#4d4d4d"              # Neutral Dark Gray (Unknown)
# Plot the tree with colored tips by species order
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order)) %<+% tip_data +
#scale_color_manual(values = viridis(length(unique(order_factors)))) +
scale_color_manual(values = custom_colors) +
theme(
legend.text = element_text(size = 10),
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 2, align = TRUE, offset = 0.1) +
labs(color = "Species Class")  # Add legend title for clarity
# Display the plot
p
# Define a custom color palette for the unique orders
# Define a custom darker color palette for the unique orders
custom_colors <- c(
# Birds
"Aves" = "#d95f02",             # Dark Orange (Birds)
# Worms
"Polychaeta" = "#7f0000",       # Dark Maroon (Bristle Worms)
"Pilidiophora" = "#7f0000",     # Dark Maroon (Ribbon Worms)
"Enteropneusta" = "#7f0000",    # Dark Maroon (Acorn Worms)
# Insects & Arthropods
"Insecta" = "#7570b3",          # Dark Purple-Blue (Insects)
"Arachnida" = "#7570b3",        # Dark Purple-Blue (Spiders, Scorpions)
"Pycnogonida" = "#7570b3",      # Dark Purple-Blue (Sea Spiders)
"Thecostraca" = "#7570b3",      # Dark Purple-Blue (Barnacles)
"Branchiopoda" = "#7570b3",     # Dark Purple-Blue (Water Fleas)
# Fish
"Myxini" = "#1b9e77",           # Dark Teal (Hagfish)
"Actinopteri" = "#1b9e77",      # Dark Teal (Ray-finned Fishes)
"Chondrichthyes" = "#1b9e77",   # Dark Teal (Cartilaginous Fishes like Sharks)
"Cladistia" = "#1b9e77",        # Dark Teal (Bichirs and Reedfishes)
"Hyperoartia" = "#1b9e77",      # Dark Teal (Lampreys)
# Sponges
"Demospongiae" = "#1f78b4",     # Dark Blue (Common Sponges)
"Calcarea" = "#1f78b4",         # Dark Blue (Calcareous Sponges)
"Homoscleromorpha" = "#1f78b4", # Dark Blue (Simple Sponges)
# Mammals
"Mammalia" = "#7570b3",         # Dark Purple (Mammals, including Primates)
# Clams & Mollusks
"Bivalvia" = "#33a02c",         # Forest Green (Clams, Oysters)
"Gastropoda" = "#33a02c",       # Forest Green (Snails, Slugs)
"Polyplacophora" = "#33a02c",   # Forest Green (Chitons)
# Octopuses & Squids
"Cephalopoda" = "#045a8d",      # Dark Navy Blue (Octopuses, Squids)
# Corals & Cnidarians
"Anthozoa" = "#e6ab02",         # Dark Mustard Yellow (Corals, Sea Anemones)
"Scyphozoa" = "#e6ab02",        # Dark Mustard Yellow (True Jellyfish)
"Hydrozoa" = "#e6ab02",         # Dark Mustard Yellow (Hydras, Portuguese Man O' War)
# Other Echinoderms
"Holothuroidea" = "#006d2c",    # Dark Green (Sea Cucumbers)
"Echinoidea" = "#006d2c",       # Dark Green (Sea Urchins)
"Asteroidea" = "#006d2c",       # Dark Green (Sea Stars)
# Other Miscellaneous
"Lepidosauria" = "#666666",     # Dark Gray (Lizards, Snakes)
"Filasterea" = "#666666",       # Dark Gray (Single-celled organisms related to animals)
"Lingulata" = "#666666",        # Dark Gray (Brachiopods)
"Leptocardii" = "#666666"       # Dark Gray (Lancelets)
# Unknown/NA category
"<NA>" = "#4d4d4d"              # Neutral Dark Gray (Unknown)
unique(order_factors)
# Define a custom color palette for the unique orders
# Define a custom darker color palette for the unique orders
custom_colors <- c(
# Birds
"Aves" = "#d95f02",             # Dark Orange (Birds)
# Worms
"Polychaeta" = "#7f0000",       # Dark Maroon (Bristle Worms)
"Pilidiophora" = "#7f0000",     # Dark Maroon (Ribbon Worms)
"Enteropneusta" = "#7f0000",    # Dark Maroon (Acorn Worms)
# Insects & Arthropods
"Insecta" = "#7570b3",          # Dark Purple-Blue (Insects)
"Arachnida" = "#7570b3",        # Dark Purple-Blue (Spiders, Scorpions)
"Pycnogonida" = "#7570b3",      # Dark Purple-Blue (Sea Spiders)
"Thecostraca" = "#7570b3",      # Dark Purple-Blue (Barnacles)
"Branchiopoda" = "#7570b3",     # Dark Purple-Blue (Water Fleas)
# Fish
"Myxini" = "#1b9e77",           # Dark Teal (Hagfish)
"Actinopteri" = "#1b9e77",      # Dark Teal (Ray-finned Fishes)
"Chondrichthyes" = "#1b9e77",   # Dark Teal (Cartilaginous Fishes like Sharks)
"Cladistia" = "#1b9e77",        # Dark Teal (Bichirs and Reedfishes)
"Hyperoartia" = "#1b9e77",      # Dark Teal (Lampreys)
# Sponges
"Demospongiae" = "#1f78b4",     # Dark Blue (Common Sponges)
"Calcarea" = "#1f78b4",         # Dark Blue (Calcareous Sponges)
"Homoscleromorpha" = "#1f78b4", # Dark Blue (Simple Sponges)
# Mammals
"Mammalia" = "#7570b3",         # Dark Purple (Mammals, including Primates)
# Clams & Mollusks
"Bivalvia" = "#33a02c",         # Forest Green (Clams, Oysters)
"Gastropoda" = "#33a02c",       # Forest Green (Snails, Slugs)
"Polyplacophora" = "#33a02c",   # Forest Green (Chitons)
# Octopuses & Squids
"Cephalopoda" = "#045a8d",      # Dark Navy Blue (Octopuses, Squids)
# Corals & Cnidarians
"Anthozoa" = "#e6ab02",         # Dark Mustard Yellow (Corals, Sea Anemones)
"Scyphozoa" = "#e6ab02",        # Dark Mustard Yellow (True Jellyfish)
"Hydrozoa" = "#e6ab02",         # Dark Mustard Yellow (Hydras, Portuguese Man O' War)
# Other Echinoderms
"Holothuroidea" = "#006d2c",    # Dark Green (Sea Cucumbers)
"Echinoidea" = "#006d2c",       # Dark Green (Sea Urchins)
"Asteroidea" = "#006d2c",       # Dark Green (Sea Stars)
# Other Miscellaneous
"Lepidosauria" = "#666666",     # Dark Gray (Lizards, Snakes)
"Filasterea" = "#666666",       # Dark Gray (Single-celled organisms related to animals)
"Lingulata" = "#666666",        # Dark Gray (Brachiopods)
"Leptocardii" = "#666666",       # Dark Gray (Lancelets)
# Unknown/NA category
"<NA>" = "#4d4d4d"              # Neutral Dark Gray (Unknown)
)
# Plot the tree with colored tips by species order
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order)) %<+% tip_data +
#scale_color_manual(values = viridis(length(unique(order_factors)))) +
scale_color_manual(values = custom_colors) +
theme(
legend.text = element_text(size = 10),
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 2, align = TRUE, offset = 0.1) +
labs(color = "Species Class")  # Add legend title for clarity
# Display the plot
p
# Plot the tree with colored tips by species order
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
#scale_color_manual(values = viridis(length(unique(order_factors)))) +
scale_color_manual(values = custom_colors) +
theme(
legend.text = element_text(size = 10),
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 2, align = TRUE, offset = 0.1) +
labs(color = "Species Class")  # Add legend title for clarity
# Display the plot
p
# Find the nodes for TEC, SRC, and ABL clades
find_clade_node <- function(tree, clade_tips) {
clade_node <- getMRCA(tree, which(tree$tip.label %in% clade_tips))
return(clade_node)
}
# Replace with actual tip labels that correspond to TEC, SRC, and ABL
tec_tips <- grep("TEC", midpoint_tree$tip.label, value = TRUE)
src_tips <- grep("SRC", midpoint_tree$tip.label, value = TRUE)
abl_tips <- grep("ABL", midpoint_tree$tip.label, value = TRUE)
# Get the nodes for each clade
tec_node <- find_clade_node(midpoint_tree, tec_tips)
src_node <- find_clade_node(midpoint_tree, src_tips)
abl_node <- find_clade_node(midpoint_tree, abl_tips)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
legend.text = element_text(size = 10),
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1, align = TRUE, offset = 0.1) +
labs(color = "Species Order") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 1, barsize = 2, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 1.1, barsize = 2, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 1, barsize = 2, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
legend.text = element_text(size = 10),
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1, align = TRUE, offset = 0.1) +
labs(color = "Species Order") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 2, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 2, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 2, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
legend.text = element_text(size = 10),
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1, align = TRUE, offset = 0.1) +
labs(color = "Species Order") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 4, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 4, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 4, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
legend.text = element_text(size = 10),
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1, align = TRUE, offset = 0.1) +
labs(color = "Species Order") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 8, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 8, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 8, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
colors <- c(
"#d95f02",  # Dark Orange (Birds)
"#7f0000",  # Dark Maroon (Worms)
"#7570b3",  # Dark Purple-Blue (Insects & Arthropods)
"#1b9e77",  # Dark Teal (Fish)
"#1f78b4",  # Dark Blue (Sponges)
"#7570b3",  # Dark Purple (Mammals)
"#33a02c",  # Forest Green (Clams & Mollusks)
"#045a8d",  # Dark Navy Blue (Octopuses & Squids)
"#e6ab02",  # Dark Mustard Yellow (Corals & Cnidarians)
"#006d2c",  # Dark Green (Other Echinoderms)
"#666666"   # Dark Gray (Miscellaneous)
)
# Create an empty plot with no axes
plot(1:10, type = "n", xlab = "", ylab = "", axes = FALSE)
# Add a legend to the plot
legend("center", legend = categories, fill = colors, cex = 0.8, title = "Categories", box.lty = 0)
# Define the categories and corresponding colors
categories <- c(
"Birds",
"Worms",
"Insects & Arthropods",
"Fish",
"Sponges",
"Mammals",
"Clams & Mollusks",
"Octopuses & Squids",
"Corals & Cnidarians",
"Other Echinoderms",
"Miscellaneous"
)
colors <- c(
"#d95f02",  # Dark Orange (Birds)
"#7f0000",  # Dark Maroon (Worms)
"#7570b3",  # Dark Purple-Blue (Insects & Arthropods)
"#1b9e77",  # Dark Teal (Fish)
"#1f78b4",  # Dark Blue (Sponges)
"#7570b3",  # Dark Purple (Mammals)
"#33a02c",  # Forest Green (Clams & Mollusks)
"#045a8d",  # Dark Navy Blue (Octopuses & Squids)
"#e6ab02",  # Dark Mustard Yellow (Corals & Cnidarians)
"#006d2c",  # Dark Green (Other Echinoderms)
"#666666"   # Dark Gray (Miscellaneous)
)
# Create an empty plot with no axes
plot(1:10, type = "n", xlab = "", ylab = "", axes = FALSE)
# Add a legend to the plot
legend("center", legend = categories, fill = colors, cex = 0.8, title = "Categories", box.lty = 0)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.text = "none",
legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 8, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 8, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 8, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.position = "none",
#legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 8, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 8, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 8, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.position = "none",
#legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 3, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 8, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 8, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 8, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.position = "none",
#legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 2, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 8, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 8, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 8, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.position = "none",
#legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1.5, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 8, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 8, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 8, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.position = "none",
#legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1.5, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 0.1, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 0.1, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 0.1, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.position = "none",
#legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1.5, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 0.01, barsize = 1, fontsize = 3, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 0.01, barsize = 1, fontsize = 3, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 0.01, barsize = 1, fontsize = 3, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
# Define the categories and corresponding colors
categories <- c(
"Birds",
"Worms",
"Insects & Arthropods",
"Fish",
"Sponges",
"Mammals",
"Clams & Mollusks",
"Octopuses & Squids",
"Corals & Cnidarians",
"Other Echinoderms",
"Miscellaneous"
)
colors <- c(
"#d95f02",  # Dark Orange (Birds)
"#7f0000",  # Dark Maroon (Worms)
"#7570b3",  # Dark Purple-Blue (Insects & Arthropods)
"#1b9e77",  # Dark Teal (Fish)
"#1f78b4",  # Dark Blue (Sponges)
"#7570b3",  # Dark Purple (Mammals)
"#33a02c",  # Forest Green (Clams & Mollusks)
"#045a8d",  # Dark Navy Blue (Octopuses & Squids)
"#e6ab02",  # Dark Mustard Yellow (Corals & Cnidarians)
"#006d2c",  # Dark Green (Other Echinoderms)
"#666666"   # Dark Gray (Miscellaneous)
)
# Create an empty plot with no axes
plot(1:10, type = "n", xlab = "", ylab = "", axes = FALSE)
# Add a legend to the plot
legend("center", legend = categories, fill = colors, cex = 0.8, title = "Categories", box.lty = 0)
# Plot the tree with species orders and annotated clades
p <- ggtree(midpoint_tree, layout = "circular", aes(color = order),branch.length = "none") %<+% tip_data +
scale_color_manual(values = custom_colors) +
theme(
#legend.text = element_text(size = 10),
legend.position = "none",
#legend.title = element_text(size = 12),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(10, 10, 10, 10)
) +
geom_tiplab(aes(label = label), size = 1.5, align = TRUE, offset = 0.1) +
labs(color = "Species Class") +  # Add legend title for clarity
# Annotate the TEC clade
geom_cladelabel(node = tec_node, label = "TEC", offset = 0.01, barsize = 1, fontsize = 4, color = "#377eb8") +
# Annotate the SRC clade
geom_cladelabel(node = src_node, label = "SRC", offset = 0.01, barsize = 1, fontsize = 4, color = "#4daf4a") +
# Annotate the ABL clade
geom_cladelabel(node = abl_node, label = "ABL", offset = 0.01, barsize = 1, fontsize = 4, color = "#e41a1c")
# Display the plot with clade annotations
print(p)
